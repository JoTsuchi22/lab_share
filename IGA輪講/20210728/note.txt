IGA 輪講メモ

2.4.1.1 A template for a circle
NURBSの円の表現方法のテンプレートということで，

円は工学設計において最も一般的なオブジェクトの1つで，
NURBSを使って円を作成する方法はたくさんあります．

円を作成する複雑な技術としては，
ウェイトを負にする方法やコントロールポイントを無限大の位置に置く方法があるんですが，
今回の目的にはどちらも適していないので，ここでは最もシンプルな方法を紹介しています．

より詳細な説明は，ピーグル アンド ティラーさんの1997年の論文を参照してくださいと書いてありました．

これより先は，最もシンプルな円の作成方法の具体的な説明になっています．

図2.4に示すように，180度以下の円弧は1つの2次NURBS要素(p=2)から構成できます．

図2.4の例ではコントロールポイントが3点で，ノットベクトルを
オープンノットベクトルにすると3つの基底関数のうち最初と最後が補完されて，
コントロールポイントが円弧の端点と一致します．

このときそれぞれのコントロールポイントにつき1つずつスカラー値の重みwを設定するんですけど，
オープンノットベクトルの端点となるB1とB3で重みを1にします．(つまり，w1=w3=1とします．)

それで，残りの制御点，この例だとB2はB1とB3の円との接線の交点に設定します．
たぶん図で見たほうがわかりやすいと思うんですけど，B1，B3から垂線を引いて，
その交点をB2とします．
(あんまり重要ではないんですけど，
一応以上のことから180度以下でないといけないことがわかります．)

それから，図の位置をthetaとするとw2 = cos(theta/2)とすると円を作成できます．

180度以上の円弧を作成する場合は，180度以下の区間で分割して，
それぞれの区間で円弧を作成すればいいです．
これらは別のパッチである必要はないんですが，円弧が交わる分では
基底関数がC0連続となると書いてありました．

この理由については49ページの図2.28を見るとわかって，
作成しようとしているのは実際のジオメトリではなくて，
射影Bスプラインで連続性が制限されているケースなので，
制御点を適切に選択することでジオメトリの連続性が保たれます．

ここからは具体例の説明をしていて，

図2.25では4つの90度の円弧から完全な円を作成しています．
先ほど説明したパッチのようにそれぞれの円弧を別のパッチで表現することもできるんですが，
そうすると円弧が交わる部分ですね，90度とか180度とか270度とかでコントロールポイントが
重寝なくちゃいけないんで，同じ点に冗長な，余分なコントロールポイントができるため，
効率が悪ので，複数の円弧をもつ1つのパッチを使って，各円弧の境界をC0連続となるように
ノットベクトルを設定しています．
この例では，ノットベクトルは[000112233444]としていて，特殊な感じなんですが，
これで図のB1，B3，B5，B7，B9でC0連続となって，他の点でC1連続となっています．
結果的に円弧を4パッチに分ける方法と同じ形状が表せて，さらに冗長な制御点を減らせました．

ただ，最初と最後の制御点B1とB9は重ねているので注意する必要があります．ということでした．


僕も一応やってみたんですけど，重みが全部1のときのただのBスプラインとNURBSの円弧を比較すると
この画像のようになって，(x, y)座標は丸め誤差だけになったので厳密に円が表現できてることが
確認できました．
